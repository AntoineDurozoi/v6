DELIMITER $$

DROP PROCEDURE IF EXISTS drop_index_if_exists $$
CREATE PROCEDURE drop_index_if_exists(in theTable varchar(128), in theIndexName varchar(128) )
BEGIN
 IF((SELECT COUNT(*) AS index_exists FROM information_schema.statistics WHERE TABLE_SCHEMA = DATABASE() and table_name =
theTable AND index_name = theIndexName) > 0) THEN
   SET @s = CONCAT('DROP INDEX ' , theIndexName , ' ON ' , theTable);
   PREPARE stmt FROM @s;
   EXECUTE stmt;
 END IF;
END $$

DELIMITER ;

call drop_index_if_exists('jos_fabrik_elements', 'showinsummary');
call drop_index_if_exists('jos_fabrik_elements', 'plugin');
call drop_index_if_exists('jos_fabrik_elements', 'join_checked_out');
call drop_index_if_exists('jos_fabrik_elements', 'join_group_id');
call drop_index_if_exists('jos_fabrik_elements', 'parent_id');
call drop_index_if_exists('jos_fabrik_elements', 'private');
call drop_index_if_exists('jos_fabrik_elements', 'is_join');
call drop_index_if_exists('jos_fabrik_elements', 'published');

call drop_index_if_exists('jos_fabrik_groups', 'private');
call drop_index_if_exists('jos_fabrik_groups', 'is_join');
call drop_index_if_exists('jos_fabrik_groups', 'published');

call drop_index_if_exists('jos_fabrik_formgroup', 'form_id');
call drop_index_if_exists('jos_fabrik_formgroup', 'group_id');
call drop_index_if_exists('jos_fabrik_formgroup', 'ordering');
call drop_index_if_exists('jos_fabrik_formgroup', 'join_group_id');
call drop_index_if_exists('jos_fabrik_formgroup', 'join_form_id');

call drop_index_if_exists('jos_fabrik_lists', 'form_id');
call drop_index_if_exists('jos_fabrik_lists', 'connection_id');
call drop_index_if_exists('jos_fabrik_lists', 'published');
call drop_index_if_exists('jos_fabrik_lists', 'private');
call drop_index_if_exists('jos_fabrik_lists', 'access');
call drop_index_if_exists('jos_fabrik_lists', 'hits');

call drop_index_if_exists('jos_fabrik_joins', 'hits');
call drop_index_if_exists('jos_fabrik_joins', 'list_id');
call drop_index_if_exists('jos_fabrik_joins', 'element_id');
call drop_index_if_exists('jos_fabrik_joins', 'group_id');